new entry "KGB_SELUNESGRACE_AURA"
type "StatusData"
data "StatusType" "BOOST"
// Moonbeam
data "DisplayName" "h884e9694g454dg4b19g9341g0351dcfffad0;2"
// Ghostly flames engulf any creature that enters this silvery light or starts its turn inside the light. They deal [1]. On a successful save, targets still take half damage.
data "Description" "h444939b4g734eg4c9cg8fd8g8170a0f37e9c;4"
data "DescriptionParams" "DealDamage(LevelMapValue(MartialArts),Radiant)"
data "Icon" "Spell_Evocation_Moonbeam"
data "StackId" "MOONBEAM_AURA"
data "AuraRadius" "1"
data "AuraStatuses" "TARGET:IF(Character() and not Dead()):ApplyStatus(KHB_SELUNESGRACE,100,-1)"
data "Boosts" "GameplayLight(2,false,0.1)"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;InitiateCombat;BringIntoCombat"
data "StatusEffect" "dd02e9e1-8ab7-4da0-9097-26fd886c06d4"


new entry "KHB_SELUNESGRACE"
type "StatusData"
data "StatusType" "BOOST"
// Moonbeam
data "DisplayName" "heb1d42dfgaad2g4ca6gabf7g83b101791226;2"
// Creature is engulfed by ghostly flames that deal [1] per turn. On a successful save, the creature still takes half damage.
data "Description" "hddd473aegb174g4f67g934dg1399cdcebc9d;2"
data "DescriptionParams" "DealDamage(LevelMapValue(MartialArts),Radiant)"
data "Icon" "Spell_Evocation_Moonbeam"
data "SoundStart" "Spell_Status_MoonBeam_Enter"
data "SoundLoop" "Spell_Status_MoonBeam_MO"
data "SoundStop" "Spell_Status_MoonBeam_MO_Stop"
data "StackId" "MOONBEAM"
data "TickType" "StartTurn"
data "StatusPropertyFlags" "InitiateCombat;BringIntoCombat"
data "OnApplyRoll" "not SavingThrow(Ability.Constitution,CalculateSpellDC(context.PreferredCastingAbility, GetSummoner(context.Source)))"
data "OnApplySuccess" "IF(Enemy()):DealDamage(LevelMapValue(MartialArts), Radiant,Magical); IF(Enemy()):ApplyStatus(KHB_SELUNESGRACE,100,1);IF(Ally()):RegainHitPoints(LevelMapValue(MartialArts))"
data "OnApplyFail" "DealDamage(LevelMapValue(MartialArts) / 2,Radiant,Magical);IF(Ally()):RegainHitPoints(LevelMapValue(MartialArts))"
data "OnTickRoll" "not SavingThrow(Ability.Constitution,CalculateSpellDC(context.PreferredCastingAbility, GetSummoner(context.Source)))"
data "OnTickSuccess" "IF(Enemy()):DealDamage(LevelMapValue(MartialArts), Radiant,Magical); IF(Enemy()):ApplyStatus(KHB_SELUNESGRACE,100,1);IF(Ally()):RegainHitPoints(LevelMapValue(MartialArts))"
data "OnTickFail" "DealDamage(2d10/2,Radiant,Magical);IF(Ally()):RegainHitPoints(LevelMapValue(MartialArts))"
data "ApplyEffect" "62710804-ff29-4936-9d45-0e6a44372526"
data "StatusEffect" "73f8b212-1a39-4214-8a32-b5e1427ec860"